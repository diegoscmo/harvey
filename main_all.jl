################################################################################
# Lagrangiano Aumentado // Otimização Topológica
################################################################################

# Copiar para o console para executar:
# cd(ENV["HARVEY"]);
# include("main_all.jl"); main_all();

# Carrega os arquivos com as rotinas de elementos finitos
include("fem\\Gera_Malha.jl")       # GeraMalha, gl_livres_elemento
include("fem\\Quad4.jl")            # Kquad4, Kquad4_I
include("fem\\Monta_Global.jl")     # Global, Expande_Vetor
include("fem\\Gmsh.jl")             # Funções GMSH
include("fem\\Harmonica.jl")         # Cálculo Harmônico

# Carrega os arquivos com métodos as rotinas para otimização
include("opt\\Top_Opt.jl")
include("opt\\Steepest.jl")         # Método de Descida, Steepest
include("opt\\Wall_Search.jl")      # Procura em linha, Wall_Search
include("opt\\Filtros.jl")          # Filtros de densidades e sensibilidades
include("opt\\Saida.jl")            # Impressão das saídas em arquivo e console

# Carrega cálculo da Fobj, Lagrangiana e derivadas, selecionar um
include("fobj\\0_Todas_Fobj.jl")

function main()

          #Num; Caso;   Freq;   Alfa;   Beta;   Ye/Rm;  A;      X0
    dsm = [
            1   1       0.0     0.0     0.0     0.0     0.0     0.49
            2   2       5.0     0.0     1E-8    0.0     0.0     0.49
            3   2       100.0   0.0     1E-8    0.0     0.0     0.49
            4   2       170.0   0.0     1E-8    0.0     0.0     0.49
            5   2       180.0   0.0     1E-8    0.0     0.0     0.49
            6   3       180.0   0.0     1E-8    1.0     0.0     0.49
            7   3       180.0   0.0     1E-8    0.75    0.0     0.49
            8   3       600.0   0.0     1E-8    1.0     0.0     0.49
            9   3       600.0   0.0     1E-8    0.5     0.0     0.49
            10  3       600.0   0.0     1E-8    0.3     0.0     0.49
            11  3       600.0   0.0     1E-8    0.2     0.0     0.49
            12  3       750.0   0.0     1E-8    1.0     0.0     0.49
            13  3       750.0   0.0     1E-8    0.5     0.0     0.49
            14  3       750.0   0.0     1E-8    0.3     0.0     0.49
            15  3       750.0   0.0     1E-8    0.2     0.0     0.49
            16  4       180.0   0.0     1E-8    0.0     0.99    0.49
            17  4       180.0   0.0     1E-8    0.0     0.90    0.49
            18  4       180.0   0.0     1E-8    0.0     0.50    0.49
            19  4       180.0   0.0     1E-8    0.0     0.25    0.49
            20  4       180.0   0.0     1E-8    0.0     0.05    0.49
            21  4       180.0   0.0     1E-8    0.0     0.01    0.49
            22  2       180.0   0.0     1E-2    0.0     0.00    0.49
            23  2       750.0   0.0     1E-2    0.0     0.00    0.49
            24  2       180.0   1000.0  0.0     0.0     0.00    0.49
            25  2       750.0   1000.0  0.0     0.0     0.00    0.49
            26  2       750.0   0.0     1E-3    0.0     0.00    0.49
            27  2       180.0   0.0     1E-8    0.0     0.00    0.49
            28  2       180.0   0.0     1E-4    0.0     0.00    0.49
            29  2       750.0   0.0     1E-8    0.0     0.00    0.49
            30  2       750.0   0.0     1E-4    0.0     0.00    0.49
            31  5       005.0   0.0     1E-8    0.0     0.00    0.49
            32  5       100.0   0.0     1E-8    0.0     0.00    0.49
            33  5       170.0   0.0     1E-8    0.0     0.00    0.49
            34  5       180.0   0.0     1E-8    0.0     0.00    0.49
            35  5       180.0   0.0     666.6   0.0     0.00    0.49
            36  5       600.0   0.0     666.6   0.0     0.00    0.49
            37  5       750.0   0.0     666.0   0.0     0.00    0.49
            38  5       005.0   1.0     0.0     0.0     0.00    0.49
            39  5       100.0   1.0     0.0     0.0     0.00    0.49
            40  5       170.0   1.0     0.0     0.0     0.00    0.49
            41  5       180.0   1.0     0.0     0.0     0.00    0.49
            42  5       180.0   666.6   0.0     0.0     0.00    0.49
            43  5       750.0   666.6   0.0     0.0     0.00    0.49
            44  5       1350.0  666.6   0.0     0.0     0.00    0.49
            45  6       180.0   0.0     666.6   1.0     0.00    0.49
            46  6       180.0   666.6   0.0     1.0     0.00    0.49
            47  6       180.0   0.0     666.6   1.5     0.00    0.49
            48  6       180.0   0.0     666.6   2.0     0.00    0.49
            49  6       180.0   0.0     666.6   5.0     0.00    0.49
            50  6       180.0   0.0     666.6   10.0    0.00    0.49
            51  6       180.0   0.0     666.6   20.0    0.00    0.49
            52  6       180.0   0.0     666.6   0.5     0.00    0.49
            53  6       600.0   0.0     1E-8    1.0     0.00    0.49
            54  6       600.0   0.0     666.6   1.0     0.00    0.49
            55  6       600.0   0.0     666.6   0.3     0.00    0.49
            56  6       600.0   0.0     666.6   0.5     0.00    0.49
            57  6       600.0   0.0     666.6   2.0     0.00    0.49
            58  6       600.0   0.0     666.6   5.0     0.00    0.49
            59  6       600.0   0.0     666.6   10.0    0.00    0.49
            60  6       600.0   0.0     666.6   15.0    0.00    0.49
            61  6       750.0   0.0     666.6   1.0     0.00    0.49
            62  6       750.0   0.0     666.6   0.5     0.00    0.49
            63  6       750.0   0.0     666.6   0.3     0.00    0.49
            64  7       750.0   0.0     666.6   0.0     0.99    0.49
            65  7       750.0   0.0     666.6   0.0     0.95    0.49
            66  7       750.0   0.0     666.6   0.0     0.90    0.49
            67  7       750.0   0.0     666.6   0.0     0.80    0.49
            68  7       750.0   0.0     666.6   0.0     0.70    0.49
            69  7       750.0   0.0     666.6   0.0     0.50    0.49
            70  7       750.0   0.0     666.6   0.0     0.30    0.49
            71  7       750.0   0.0     666.6   0.0     0.10    0.49
            72  6       1450.0  0.0     1E-8    1.0     0.00    0.49
            73  7       1450.0  0.0     666.6   0.0     0.95    0.49
            74  7       1450.0  0.0     666.6   0.0     0.90    0.49
            75  7       1450.0  0.0     666.6   0.0     0.50    0.49
            76  7       1450.0  0.0     666.6   0.0     0.30    0.49
            77  7       1450.0  0.0     666.6   0.0     0.10    0.49
            78  7       180.0   0.0     666.6   0.0     0.999   0.49
            79  7       180.0   0.0     666.6   0.0     0.99    0.49
            80  7       600.0   0.0     666.6   0.0     0.999   0.49
            81  7       600.0   0.0     666.6   0.0     0.99   0.49
            82  8       600.0   0.0     666.6   1.0     0.99    0.49
            83  8       600.0   0.0     666.6   1.0     0.90    0.49
            84  8       600.0   0.0     666.6   1.0     0.50    0.49
            85  8       600.0   0.0     666.6   1.0     0.30    0.49
            86  8       400.0   0.0     666.6   1.0     0.30    0.49
            87  8       180.0   0.0     666.6   1.0     0.99    0.49
            88  8       180.0   0.0     666.6   1.0     0.99    0.20
            89  8       180.0   0.0     666.6   1.0     0.90    0.20
            90  8       1350.0  0.0     666.6   1.0     0.90    0.49
            91  8       1350.0  0.0     666.6   1.0     0.80    0.49
            92  8       1350.0  0.0     666.6   1.0     0.70    0.49
            93  8       1350.0  0.0     666.6   1.0     0.30    0.49
            94  8       250.0   0.0     666.6   1.0     0.70    0.49
            95  8       250.0   0.0     666.6   1.001   -0.70   0.49
            96  8       400.0   0.0     666.6   1.000   -0.70   0.49
            97  8       400.0   0.0     666.6   1.001   -0.70   0.49
            98  8       400.0   0.0     666.6   1.001   -0.50   0.49
            99  8       600.0   0.0     666.6   1.001   -0.70   0.49
            100 8       600.0   0.0     666.6   0.999   -0.70   0.49
            101 8       700.0   0.0     666.6   0.999   -0.50   0.49
            102 8       100.0   0.0     666.6   0.999   -0.90   0.49
            103 8       100.0   0.0     666.6   0.999   -0.80   0.49
            104 8       100.0   0.0     666.6   1.001   -0.80   0.49
            105 8       100.0   0.0     666.6   1.001   -0.20   0.49
]

    for i=45:45     #1:105

        num  = Int(dsm[i,1]);
        caso = Int(dsm[i,2]);
        freq = dsm[i,3];
        alfa = dsm[i,4];
        beta = dsm[i,5];
        Ye   = dsm[i,6];
        A    = dsm[i,7];
        X0   = dsm[i,8];

        if alfa == 666.6
            alfa = 0.8*(2.0*pi*freq)
        end
        if beta == 666.6
            beta = 0.1/(2.0*pi*freq)
        end

        Top_Opt(num, caso, freq, alfa, beta, Ye, A, X0)

    end
    quit()
end
